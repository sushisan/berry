<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Grammar Definition &mdash; berry 1.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> berry
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Home.html">Welcome to the berry wiki!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../es/Home.html">Bienvenido a la wiki de Berry!</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">berry</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Grammar Definition</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/en/Appendix-A.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="grammar-definition">
<h1>Grammar Definition<a class="headerlink" href="#grammar-definition" title="Permalink to this headline">¶</a></h1>
<p>This chapter will give some grammar definitions related to Berry. We use
<strong>Extended Backus Normal Form</strong> (EBNF) to define or express grammar. We
did not use strict EBNF grammar to define, but made a lot of
simplifications, but these simplifications will not affect readers’
understanding of the grammar.</p>
<p>The EBNF definition of Berry language grammar is as follows:</p>
<div class="highlight-ebnf notranslate"><div class="highlight"><pre><span></span>(* program define *)
program = block;
(* block define *)
block = {statement};
(* statement define *)
statement = class_stmt | func_stmt | var_stmt | if_stmt | while_stmt |
         for_stmt | break_stmt | return_stmt | expr_stmt | import_stmt |
         try_stmt | throw_stmt | &#39;;&#39;;
if_stmt = &#39;if&#39; expr block {&#39;elif&#39; expr block} [&#39;else&#39; block] &#39;end&#39;;
while_stmt = &#39;while&#39; expr block &#39;end&#39;;
for_stmt = &#39;for&#39; ID &#39;:&#39; expr block &#39;end&#39;;
break_stmt = &#39;break&#39; | &#39;continue&#39;;
return_stmt = &#39;return&#39; [expr];
(* function define statement *)
func_stmt = &#39;def&#39; ID func_body;
func_body = &#39;(&#39; [arg_field {&#39;,&#39; arg_field}] &#39;)&#39; block &#39;end&#39;;
arg_field = [&#39;*&#39;] ID;
(* class define statement *)
class_stmt = &#39;class&#39; ID [&#39;:&#39; ID] class_block &#39;end&#39;;
class_block = {&#39;var&#39; ID {&#39;,&#39; ID} | &#39;static&#39; [&#39;var&#39;] ID [&#39;=&#39; expr] {&#39;,&#39; ID [&#39;=&#39; expr] } | &#39;static&#39; func_stmt | func_stmt};
import_stmt = &#39;import&#39; (ID ([&#39;as&#39; ID] | {&#39;,&#39; ID}) | STRING &#39;as&#39; ID);
(* exceptional handling statement *)
try_stmt = &#39;try&#39; block except_block {except_block} &#39;end&#39;;
except_block = except_stmt block;
except_stmt = &#39;except&#39; (expr {&#39;,&#39; expr} | &#39;..&#39;) [&#39;as&#39; ID [&#39;,&#39; ID]];
throw_stmt = &#39;raise&#39; expr [&#39;,&#39; expr];
(* variable define statement *)
var_stmt = &#39;var&#39; ID [&#39;=&#39; expr] {&#39;,&#39; ID [&#39;=&#39; expr]};
(* expression define *)
expr_stmt = expr [assign_op expr];
expr = suffix_expr | unop expr | expr binop expr | range_expr | cond_expr;
cond_expr = expr &#39;?&#39; expr &#39;:&#39; expr; (* conditional expression *)
assign_op = &#39;=&#39; | &#39;+=&#39; | &#39;-=&#39; | &#39;*=&#39; | &#39;/=&#39; |
            &#39;%=&#39; | &#39;&amp;=&#39; | &#39;|=&#39; | &#39;^=&#39; | &#39;&lt;&lt;=&#39; | &#39;&gt;&gt;=&#39;;
binop = &#39;&lt;&#39; | &#39;&lt;=&#39; | &#39;==&#39; | &#39;!=&#39; | &#39;&gt;&#39; | &#39;&gt;=&#39; | &#39;||&#39; | &#39;&amp;&amp;&#39; |
        &#39;&lt;&lt;&#39; | &#39;&gt;&gt;&#39; | &#39;&amp;&#39; | &#39;|&#39; | &#39;^&#39; | &#39;+&#39; | &#39;-&#39; | &#39;*&#39; | &#39;/&#39; | &#39;%&#39;;
range_expr = expr &#39;..&#39; [expr]
unop = &#39;-&#39; | &#39;!&#39; | &#39;~&#39;;
suffix_expr = primary_expr {call_expr | (&#39;.&#39; ID) | &#39;[&#39; expr &#39;]&#39;};
primary_expr = &#39;(&#39; expr &#39;)&#39; | simple_expr | list_expr | map_expr | anon_func | lambda_expr;
simple_expr =  INTEGER | REAL | STRING | ID | &#39;true&#39; | &#39;false&#39; | &#39;nil&#39;;
call_expr = &#39;(&#39; [expr {&#39;,&#39; expr}] &#39;)&#39;;
list_expr = &#39;[&#39; {expr &#39;,&#39;} [expr] &#39;]&#39;;
map_expr = &#39;{&#39; {expr &#39;:&#39; expr &#39;,&#39;} [expr &#39;:&#39; expr] &#39;}&#39;;
anon_func = &#39;def&#39; func_body; (* anonymous function *)
lambda_expr = &#39;/&#39; [arg_field {&#39;,&#39; arg_field}] | {arg_field}] &#39;-&gt;&#39; expr;
</pre></div>
</div>
<p>The standard EBNF format can be found in related materials. Here is an
explanation of the details that need attention when reading the above
grammar. The symbols that have appeared to the left of the equal sign
are non-terminal symbols, and the others are terminal symbols. The
terminator enclosed in quotation marks <code class="docutils literal notranslate"><span class="pre">’</span></code> is a fixed string, which is
usually a language keyword or operator. There are several terminators
that are inconvenient to describe directly in EBNF: <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code> represents
the integer face value; <code class="docutils literal notranslate"><span class="pre">REAL</span></code> represents the real number face value;
<code class="docutils literal notranslate"><span class="pre">STRING</span></code> represents the string literal value; <code class="docutils literal notranslate"><span class="pre">ID</span></code> represents the
identifier. These terminators can be defined using regular expressions:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>: <code class="docutils literal notranslate"><span class="pre">0x[a-fA-F0-9]+|\d+</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">REAL</span></code>: <code class="docutils literal notranslate"><span class="pre">(\d+\.?|\.\d)\d*([eE][+-]?\d+)?</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">STRING</span></code>: <code class="docutils literal notranslate"><span class="pre">&quot;(\\.|[^&quot;])*&quot;|’(\\.|[^’])*’</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ID</span></code>: <code class="docutils literal notranslate"><span class="pre">[_a-zA-Z]\w*</span></code></p></li>
</ul>
<p>The symbols that appear sequentially in the standard EBNF are separated
by commas. For intuitiveness, I use spaces to implement the comma
function. The vertical bar symbol “|” is pronounced as “or”, it means
that the left and right patterns can only match one of them, or has the
lowest priority. For example, the grammar
<em>a</em><sub>0</sub><em>a</em><sub>1</sub>|<em>a</em><sub>2</sub> means either the
matching formula <em>a</em><sub>0</sub><em>a</em><sub>1</sub> or the matching
<em>a</em><sub>2</sub>. The square brackets indicate that the sub-expression
inside the parentheses are matched 0 or 1 times, the curly braces
indicate that the internal sub-expression is matched 0 or more times,
and the parentheses only have the function of taking the internal
sub-expression as a whole.</p>
<p>The following is the JSON grammar definition supported by the JSON
module in the Berry standard library. The usage of EBNF still complies
with the above conventions:</p>
<div class="highlight-ebnf notranslate"><div class="highlight"><pre><span></span><span class="k">json </span><span class="o">=</span> <span class="k">value</span><span class="p">;</span>
<span class="k">value </span><span class="o">=</span> <span class="k">object </span><span class="p">|</span> <span class="k">array </span><span class="p">|</span>
        <span class="k">string </span><span class="p">|</span> <span class="k">number </span><span class="p">|</span> <span class="s1">&#39;true&#39;</span> <span class="p">|</span> <span class="s1">&#39;false&#39;</span> <span class="p">|</span> <span class="s1">&#39;null&#39;</span><span class="p">;</span>
<span class="k">object </span><span class="o">=</span> <span class="s1">&#39;{&#39;</span> <span class="p">[</span> <span class="k">string </span><span class="s1">&#39;:&#39;</span> <span class="k">value </span><span class="p">]</span> <span class="p">{</span> <span class="s1">&#39;,&#39;</span> <span class="k">string </span><span class="s1">&#39;:&#39;</span> <span class="k">value </span><span class="p">}</span> <span class="s1">&#39;}&#39;</span><span class="p">;</span>
<span class="k">array </span><span class="o">=</span> <span class="s1">&#39;[&#39;</span> <span class="p">[</span><span class="k">json</span><span class="p">]</span> <span class="p">{</span> <span class="s1">&#39;,&#39;</span> <span class="k">json </span><span class="p">}</span> <span class="s1">&#39;]&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>Non-terminal symbols <code class="docutils literal notranslate"><span class="pre">string</span></code> and <code class="docutils literal notranslate"><span class="pre">number</span></code> can also be defined using
regular expressions. <a class="reference external" href="http://www.json.org">http://www.json.org</a> gives the standard grammar of
JSON, which also includes the definitions of <code class="docutils literal notranslate"><span class="pre">string</span></code> and <code class="docutils literal notranslate"><span class="pre">number</span></code>. The
Berry JSON library’s support for numbers is different from the standard.
The standard JSON numbers must start with “-” or the number “0-9”, while
the Berry JSON library also accepts numbers starting with a decimal
point.</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Guan Wenliang &amp; Stephan Hadinger.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>